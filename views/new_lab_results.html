
<script>
    var tt_cancel_destination = "/patients/show?identifier=<%= patientIdentifier %>"
    var tstCurrentDate = "<%= today %>";
    var labTests = JSON.parse('<%- labTests %>');
    
    function updateResultKeyPad() {
        curr_page = tstCurrentPage - 1;
        buttons = document.getElementsByClassName("keyboardButton");
        $("clearButton").setAttribute("onmousedown", "clearInput();updateResultKeyPad();");
        $("backButton").setAttribute("onmousedown", ";gotoPage(" + curr_page + ", null, true);resetPad();");
        //$("nextButton").setAttribute("onmousedown","gotoNextPage();resetPad();");   

        for (i = 0; i < buttons.length; i++) {
            if (buttons[i].id == "equals" || buttons[i].id == "greaterthan" || buttons[i].id == "lessthan") {
                buttons[i].disabled = false;
                if (buttons[i].id == "equals") {
                    buttons[i].setAttribute("onmousedown", "press('=');resetKeyPad();");
                } else if (buttons[i].id == "lessthan") {
                    buttons[i].setAttribute("onmousedown", "press('<');resetKeyPad();");
                } else if (buttons[i].id == "greaterthan") {
                    buttons[i].setAttribute("onmousedown", "press('>');resetKeyPad();");
                }
            } else {
                buttons[i].disabled = true;
            }
        }
    }


    function resetPad() {
        curr_page = tstCurrentPage - 1
        buttons = document.getElementsByClassName("keyboardButton");
        for (i = 0; i < buttons.length; i++) {
            buttons[i].disabled = false;
        }
        $("clearButton").setAttribute("onmousedown", "clearInput();");
        $("backButton").setAttribute("onmousedown", ";gotoPage(" + curr_page + ", null, true);");
        $("nextButton").setAttribute("onmousedown", "gotoNextPage();");
    }

    function resetKeyPad() {
        buttons = document.getElementsByClassName("keyboardButton");
        for (i = 0; i < buttons.length; i++) {
            if (buttons[i].id == "equals" || buttons[i].id == "greaterthan" || buttons[i].id == "lessthan") {
                buttons[i].disabled = true;
            } else {
                buttons[i].disabled = false;
            }
        }
    }

    function changeTodayButtonClassName() {
        today = document.getElementById('today');
        today.className = 'blue';
    }

    function addOptions(){
        
    }
</script>
<style>

    #lessthan , #greaterthan , #equals, #decimal {
        display: inline !important;
    }

    .tt_controls_test_result #date,#minus,#abc,#comma,#qwerty,
    #slash,#percent,#star,#plus,#date,#Unknown,#char,#backspace {     
        display:none;                                                               
    }

    .tt_controls_test_date #Unknown { display: none; }
</style>
<% include header.html %>
<body id="mateme">
    <div id="container">
        <div id="content">
            <form id='' action="#" method='post'>
                <select helpText="Available tests" id="value" name="lab_result">
                    <%- optionsForSelect %>
                </select>
                <select helpText="Test date available" id="test_date_available" name="date_available" onchange = "displayDate()">
                    <option value=""></option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
                <input tt_onLoad="changeTodayButtonClassName();" condition="$('test_date_available').value.toLowerCase() == 'yes'" 
                       field_type="date" helpText="Test date" id="test_date_id" max="<%= today %>" name="test_date" 
                       tt_pageStyleClass="Date DatesOnly" type="text" value="<%= today %>" 
                       />
                <input field_type="number" helpText="Test results" id="test_value_" name="test_value[]" 
                       size="8" tt_onLoad="updateResultKeyPad();" type="text" 
                       validationMessage="You must specify >, < or =" validationRule="^(>|<|=|U|M)([\d.]+|nknown|issing)$" 
                       />
                
                <input id="patient_identifier" name="patient_identifier" type="hidden" value="<%= patientIdentifier %>" />
            </form>
            <!--<div id="footer">
            </div>-->
        </div>
    </div>
</body>

